<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Detalhe do Ponto de Coleta</title>

    <link rel="stylesheet" href="./css/newDash.css">
    <link rel="shortcut icon" type="imagex/png" href="./imgs/logoSemEscrita_techbins-removebg-preview.ico">
    <link rel="preconnect" href="https://fonts.gstatic.com" />
</head>
<body>
    <div class="divTitulo" id="div_titulo">Dashboard</div>
    <h1 id="tituloPonto"></h1>
    <ul id="listaLixeiras"></ul>

    <script>
        const idPonto = sessionStorage.getItem('idPontoColetaSelecionado');
        const logradouro = sessionStorage.getItem('logradouroSelecionado');
        div_titulo.innerHTML = `<h2>Dashboard do Ponto ${logradouro}</h2>`;
        document.getElementById('tituloPonto').innerHTML = `Lixeiras do Ponto: ${logradouro}`;

        fetch("/dashboard/lixeirasPorPonto", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ idPontoServer: idPonto })
        })
        .then(res => res.json())
        .then(lixeiras => {
            console.log(lixeiras)
            const ul = document.getElementById('listaLixeiras');
            lixeiras.forEach(lixeira => {
                let cor = "gray";
                let nivel = 0;
                if (lixeira.nivel >= 72 && lixeira.nivel <= 90) {
                    cor = "lawngreen";
                    nivel = 1;
                } else if (lixeira.nivel > 54 && lixeira.nivel < 72) {
                    cor = "lawngreen";
                    nivel = 2;
                } else if (lixeira.nivel > 36 && lixeira.nivel <= 54) {
                    cor = "yellow";
                    nivel = 3;
                } else if (lixeira.nivel > 18 && lixeira.nivel <= 36) {
                    cor = "orange";
                    nivel = 4;
                } else if (lixeira.nivel >= 0 && lixeira.nivel <= 18) {
                    cor = "red";
                    nivel = 5;
                }
                ul.innerHTML += `
                    <li class="lixeira-item lixeira-nivel-${nivel}" style="background-color:${cor};">
                        <img class="lixeira-img" src="./imgs/trash-512.webp" alt="Lixeira">
                        <h1 class="lixeira-info">
                            Lixeira ${lixeira.idLixeira} - NÃ­vel: <b class="lixeira-nivel">${nivel}</b>
                        </h1>
                    </li>
                `;
            });
        });
    </script>
</body>
</html>